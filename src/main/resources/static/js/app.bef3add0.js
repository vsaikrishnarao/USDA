(function(){"use strict";var e={3533:function(e,t,a){var s=a(5130),l=a(6768);function o(e,t,a,s,o,n){const r=(0,l.g2)("router-view");return(0,l.uX)(),(0,l.Wv)(r)}var n={name:"App"},r=a(1241);const i=(0,r.A)(n,[["render",o]]);var d=i,u=a(1387);const c={class:"home-container"},p={class:"sidebar-container"},m={class:"display-container"};function h(e,t,a,s,o,n){const r=(0,l.g2)("SideNav");return(0,l.uX)(),(0,l.CE)("div",c,[(0,l.Lk)("div",p,[(0,l.bF)(r,{onChangeView:n.setActiveView},null,8,["onChangeView"])]),(0,l.Lk)("div",m,[((0,l.uX)(),(0,l.Wv)((0,l.$y)(n.currentComponent)))])])}const g={class:"sidebar"},L={class:"nav navbar-nav"},k={class:"menu-item"},v={class:"menu-item"},b={class:"menu-item"},f={class:"menu-item"},y={class:"menu-item"},C={class:"menu-item"};function A(e,t,a,s,o,n){return(0,l.uX)(),(0,l.CE)("nav",g,[(0,l.Lk)("ul",L,[(0,l.Lk)("li",k,[(0,l.Lk)("a",{href:"#",onClick:t[0]||(t[0]=(...e)=>n.goHome&&n.goHome(...e))},t[6]||(t[6]=[(0,l.Lk)("span",{class:"icon-text"},[(0,l.Lk)("i",{class:"fa fa-home"}),(0,l.Lk)("span",{class:"link-text"},"Home")],-1)]))]),n.isAdmin?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[(0,l.Lk)("li",v,[(0,l.Lk)("a",{href:"#",onClick:t[1]||(t[1]=(...e)=>n.selectClass&&n.selectClass(...e))},t[7]||(t[7]=[(0,l.Lk)("span",{class:"icon-text"},[(0,l.Lk)("i",{class:"fa fa-book"}),(0,l.Lk)("span",{class:"link-text"},"Class")],-1)]))]),(0,l.Lk)("li",b,[(0,l.Lk)("a",{href:"#",onClick:t[2]||(t[2]=(...e)=>n.selectGroup&&n.selectGroup(...e))},t[8]||(t[8]=[(0,l.Lk)("span",{class:"icon-text"},[(0,l.Lk)("i",{class:"fa fa-users"}),(0,l.Lk)("span",{class:"link-text"},"Group")],-1)]))]),(0,l.Lk)("li",f,[(0,l.Lk)("a",{href:"#",onClick:t[3]||(t[3]=(...e)=>n.selectLmu&&n.selectLmu(...e))},t[9]||(t[9]=[(0,l.Lk)("span",{class:"icon-text"},[(0,l.Lk)("i",{class:"fa fa-map"}),(0,l.Lk)("span",{class:"link-text"},"LMU")],-1)]))]),(0,l.Lk)("li",y,[(0,l.Lk)("a",{href:"#",onClick:t[4]||(t[4]=(...e)=>n.addUser&&n.addUser(...e))},t[10]||(t[10]=[(0,l.Lk)("span",{class:"icon-text"},[(0,l.Lk)("i",{class:"fa fa-map"}),(0,l.Lk)("span",{class:"link-text"},"Add User")],-1)]))])],64)):(0,l.Q3)("",!0),(0,l.Lk)("li",C,[(0,l.Lk)("a",{href:"#",onClick:t[5]||(t[5]=(...e)=>n.logout&&n.logout(...e))},t[11]||(t[11]=[(0,l.Lk)("span",{class:"icon-text"},[(0,l.Lk)("i",{class:"fa fa-sign-out"}),(0,l.Lk)("span",{class:"link-text"},"Sign Out")],-1)]))])])])}a(4114);var w={name:"SideNav",computed:{isAdmin(){return"true"===sessionStorage.getItem("isAdmin")}},methods:{goHome(){this.$emit("changeView","home")},selectClass(){this.$emit("changeView","viewClass")},selectGroup(){this.$emit("changeView","viewGroup")},selectLmu(){this.$emit("changeView","viewLmu")},addUser(){this.$emit("changeView","addUser")},logout(){sessionStorage.clear(),this.$router.push("/login")}}};const S=(0,r.A)(w,[["render",A],["__scopeId","data-v-2f1d0588"]]);var D=S,G=a.p+"img/static.8de673e0.png";const x={class:"map-wrapper"},V={key:0,class:"map-container"},I={id:"map",ref:"mapContainer"};function E(e,t,a,o,n,r){return(0,l.uX)(),(0,l.CE)("div",x,[(0,l.bF)(s.eB,{name:"fade"},{default:(0,l.k6)((()=>[o.isMapVisible?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",{key:0,onClick:t[0]||(t[0]=(...e)=>o.toggleMap&&o.toggleMap(...e)),class:"image-container"},t[2]||(t[2]=[(0,l.Lk)("img",{src:G,alt:"Static Map"},null,-1),(0,l.Lk)("div",{class:"image-overlay-text"}," Click anywhere on the image to view the interactive map ",-1)])))])),_:1}),(0,l.bF)(s.eB,{name:"fade"},{default:(0,l.k6)((()=>[o.isMapVisible?((0,l.uX)(),(0,l.CE)("div",V,[(0,l.Lk)("button",{onClick:t[1]||(t[1]=(0,s.D$)(((...e)=>o.closeMap&&o.closeMap(...e)),["stop"])),class:"close-btn"},"X"),(0,l.Lk)("div",I,null,512)])):(0,l.Q3)("",!0)])),_:1})])}a(8111),a(2489),a(7588),a(1701),a(8237);var F=a(144),_=a(6886),U=a.n(_),M=a(4373),N=a(1567);N.A.defs("EPSG:32614","+proj=utm +zone=14 +datum=WGS84 +units=m +no_defs"),N.A.defs("EPSG:4326","+proj=longlat +datum=WGS84 +no_defs");var O={name:"MapView",setup(){const e=(0,u.rd)(),t=(0,F.KR)(null),a=(0,F.KR)(!1);let s=null;const o=(0,F.KR)([]),n=(0,F.KR)({}),r=async()=>{try{const e=await M.A.get("/api/groups/all");n.value=Object.fromEntries(e.data.map((e=>[e.nameGrpShort,e.id])))}catch(e){console.error("Failed to fetch group mapping:",e)}},i=()=>{a.value=!a.value},d=()=>{const e=document.querySelector(".close-btn");e?(e.classList.add("fade-out"),setTimeout((()=>{e.style.display="none",a.value=!1}),300)):a.value=!1};(0,l.wB)(a,(async e=>{e&&(await(0,l.dY)(),c())})),(0,l.sV)((async()=>{await r(),window.addEventListener("navigate-to-viewgroups",(t=>{const a=t.detail?.groupNames,s=Array.isArray(a)?a:String(a||"").replace(/[{}"]/g,"").split(",").map((e=>e.trim())).filter((e=>""!==e)),l=s.map((e=>n.value[e])).filter((e=>null!=e));sessionStorage.setItem("selectedGroupIds",JSON.stringify(l)),e.push("/viewgroups")}))}));const c=async()=>{if(t.value){s&&(s.remove(),s=null),s=U().map(t.value).setView([30,-97],6),U().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}).addTo(s);try{const e=await M.A.get("/api/lmu/named-view");e.data.forEach((e=>{if(!e.geom)return;let t;try{t=JSON.parse(e.geom)}catch(m){return void console.error("Error parsing geom for LMU",m)}if(!t.coordinates||0===t.coordinates.length)return;const a=t.coordinates[0].map((e=>{if(!e||e.length<2)return null;const[t,a]=(0,N.A)("EPSG:32614","EPSG:4326",[e[0],e[1]]);return[a,t]})).filter((e=>null!==e));if(0===a.length)return;const l=Array.isArray(e.classLabelList)?e.classLabelList:(e.classLabelList||"").toString().replace(/[{}"]/g,"").split(",").filter((e=>""!==e)),n=l.reduce(((e,t)=>(e[t]=(e[t]||0)+1,e)),{}),r=Object.entries(n).map((([e,t])=>`Class ${e}: ${t}`)).join("<br>"),i=l.length,d=Array.isArray(e.nameGrpShortList)?e.nameGrpShortList:(e.nameGrpShortList||"").toString().replace(/[{}"]/g,"").split(",").filter((e=>""!==e)).join("<br>");let u="#2a623d",c="#4caf50";"corral"===e.type?.toLowerCase()?(u="#0000ff",c="#87cefa"):"alley"===e.type?.toLowerCase()&&(u="#808080",c="#c0c0c0");const p=U().polygon(a,{color:u,fillColor:c,fillOpacity:.7,weight:2}).addTo(s);p.bindPopup(`\n            <div class="popup-content">\n              <h3>${e.label||"LMU"}</h3>\n              <p><strong>Type:</strong> ${e.type||"N/A"}</p>\n              <p><strong>Area (ha):</strong> ${e.areaHa||"N/A"}</p>\n              <p><strong>Current Grazing use:</strong> ${e.audGrz||"N/A"}</p>\n              <p><strong>Forage:</strong> ${e.forage||"N/A"}</p>\n              <p><strong>Number of days to reach Target use:</strong> ${parseInt(e.noOfDays)||"N/A"}</p>\n              <p><strong>Assigned Animal Groups:</strong><br> ${d||"N/A"}</p>\n              <p><strong>Total number of animals:</strong> ${i||0}</p>\n              <p><strong>Total AUE:</strong> ${e.totalAueGrp||"N/A"}</p>\n              <p><strong>Animal Class Breakdown:</strong><br>${r||"N/A"}</p>\n              <div style="margin-top: 10px; text-align: center;">\n                <button class="view-groups-btn">View Groups</button>\n              </div>\n            </div>\n          `),p.on("popupopen",(()=>{const t=document.querySelector(".view-groups-btn");t&&(t.onclick=()=>{const t=e.nameGrpShortList,a=Array.isArray(t)?t:String(t||"").replace(/[{}"]/g,"").split(",").map((e=>e.trim())).filter((e=>""!==e));window.dispatchEvent(new CustomEvent("navigate-to-viewgroups",{detail:{groupNames:a}}))})})),o.value.push(p)})),o.value.length>0&&s.fitBounds(o.value.map((e=>e.getBounds())))}catch(e){console.error("Error fetching LMU data:",e)}}};return{mapContainer:t,isMapVisible:a,toggleMap:i,closeMap:d}}};const R=(0,r.A)(O,[["render",E],["__scopeId","data-v-5da08324"]]);var X=R,$=a(4232);const J={class:"view-classes"},Q={class:"search-bar"},q={class:"table-wrapper"},K={class:"animal-table"},P=["value"],T={class:"footer-buttons"},j={key:0,class:"modal-overlay"},H={class:"modal-content"};function z(e,t,a,o,n,r){const i=(0,l.g2)("ClassForm");return(0,l.uX)(),(0,l.CE)("div",J,[t[11]||(t[11]=(0,l.Lk)("h2",{class:"heading"},"Animal Classes",-1)),(0,l.Lk)("div",Q,[(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>n.searchQuery=e),placeholder:"Search by Label"},null,512),[[s.Jo,n.searchQuery]]),(0,l.Lk)("button",{class:"clear",onClick:t[1]||(t[1]=(...e)=>r.clearSearch&&r.clearSearch(...e))},"Clear")]),(0,l.Lk)("div",q,[(0,l.Lk)("table",K,[(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("th",null,[(0,l.bo)((0,l.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=e=>n.selectAll=e),onChange:t[3]||(t[3]=(...e)=>r.toggleSelectAll&&r.toggleSelectAll(...e))},null,544),[[s.lH,n.selectAll]])]),t[7]||(t[7]=(0,l.Lk)("th",null,"ID",-1)),t[8]||(t[8]=(0,l.Lk)("th",null,"Label",-1)),t[9]||(t[9]=(0,l.Lk)("th",null,"AUE",-1)),t[10]||(t[10]=(0,l.Lk)("th",null,"Description",-1))])]),(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.displayedClasses,(e=>((0,l.uX)(),(0,l.CE)("tr",{key:e.id},[(0,l.Lk)("td",null,[(0,l.bo)((0,l.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=e=>n.selectedClasses=e),value:e},null,8,P),[[s.lH,n.selectedClasses]])]),(0,l.Lk)("td",null,(0,$.v_)(e.id),1),(0,l.Lk)("td",null,(0,$.v_)(e.label),1),(0,l.Lk)("td",null,(0,$.v_)(e.aue),1),(0,l.Lk)("td",null,(0,$.v_)(e.description),1)])))),128))])])]),(0,l.Lk)("div",T,[(0,l.Lk)("button",{class:"btn add-btn",onClick:t[5]||(t[5]=e=>r.openForm("add"))},"Add"),(0,l.Lk)("button",{class:"btn edit-btn",onClick:t[6]||(t[6]=e=>r.openForm("edit"))},"Edit")]),n.showFormModal?((0,l.uX)(),(0,l.CE)("div",j,[(0,l.Lk)("div",H,[(0,l.bF)(i,{mode:n.formMode,existingClass:"edit"===n.formMode?n.selectedClasses[0]:null,nextClassId:"add"===n.formMode?n.nextClassId:null,onClose:r.closeForm,onSaved:r.handleSaved},null,8,["mode","existingClass","nextClassId","onClose","onSaved"])])])):(0,l.Q3)("",!0)])}const B={class:"class-form-card"},W={class:"form-title"},Y={class:"form-group"},Z={class:"form-group"},ee={class:"form-group"},te={class:"form-actions"},ae={type:"submit",class:"btn btn-submit"};function se(e,t,a,o,n,r){return(0,l.uX)(),(0,l.CE)("div",B,[(0,l.Lk)("h2",W,(0,$.v_)("add"===a.mode?"Add New Class":"Edit Class"),1),(0,l.Lk)("form",{onSubmit:t[4]||(t[4]=(0,s.D$)(((...e)=>r.handleSubmit&&r.handleSubmit(...e)),["prevent"])),class:"class-form"},[(0,l.Lk)("div",Y,[t[5]||(t[5]=(0,l.Lk)("label",{for:"label"},"Label *",-1)),(0,l.bo)((0,l.Lk)("input",{id:"label","onUpdate:modelValue":t[0]||(t[0]=e=>n.formData.label=e),placeholder:"Enter label",required:"",class:"form-input"},null,512),[[s.Jo,n.formData.label]])]),(0,l.Lk)("div",Z,[t[6]||(t[6]=(0,l.Lk)("label",{for:"description"},"Description",-1)),(0,l.bo)((0,l.Lk)("input",{id:"description","onUpdate:modelValue":t[1]||(t[1]=e=>n.formData.description=e),placeholder:"Enter description",class:"form-input"},null,512),[[s.Jo,n.formData.description]])]),(0,l.Lk)("div",ee,[t[7]||(t[7]=(0,l.Lk)("label",{for:"aue"},"AUE *",-1)),(0,l.bo)((0,l.Lk)("input",{id:"aue",type:"number",step:"0.01","onUpdate:modelValue":t[2]||(t[2]=e=>n.formData.aue=e),placeholder:"Enter AUE",required:"",class:"form-input"},null,512),[[s.Jo,n.formData.aue]])]),(0,l.Lk)("div",te,[(0,l.Lk)("button",{type:"button",onClick:t[3]||(t[3]=t=>e.$emit("close")),class:"btn btn-cancel"},"Cancel"),(0,l.Lk)("button",ae,(0,$.v_)("add"===a.mode?"Add Class":"Save Changes"),1)])],32)])}var le={name:"ClassForm",props:{mode:{type:String,required:!0},existingClass:{type:Object,default:null},nextClassId:{type:Number,default:null}},data(){return{formData:{id:null,label:"",description:"",aue:null}}},created(){"edit"===this.mode&&this.existingClass&&(this.formData={id:this.existingClass.id,label:this.existingClass.label,description:this.existingClass.description,aue:this.existingClass.aue}),"add"===this.mode&&this.nextClassId&&(this.formData.id=this.nextClassId)},methods:{async handleSubmit(){try{const e="add"===this.mode?"/api/classes/add":"/api/classes/edit",t=await M.A.post(e,this.formData);t.data&&t.data.includes("already exists")?alert(t.data):(alert("add"===this.mode?"Class added successfully!":"Class updated successfully!"),this.$emit("saved"))}catch(e){console.error("Error:",e),alert("Failed to save class.")}}}};const oe=(0,r.A)(le,[["render",se],["__scopeId","data-v-01f03537"]]);var ne=oe,re={name:"ViewClass",components:{ClassForm:ne},data(){return{classes:[],searchQuery:"",selectedClasses:[],selectAll:!1,showFormModal:!1,formMode:"add",nextClassId:null}},computed:{displayedClasses(){return""!==this.searchQuery.trim()?this.classes.filter((e=>e.label.toLowerCase().includes(this.searchQuery.toLowerCase()))):this.classes}},created(){this.fetchClasses()},methods:{fetchClasses(){M.A.get("/api/classes/all").then((e=>{this.classes=e.data,this.calculateNextId()})).catch((e=>{console.error("Error fetching classes:",e)}))},calculateNextId(){this.classes.length>0?this.nextClassId=Math.max(...this.classes.map((e=>e.id)))+1:this.nextClassId=1},toggleSelectAll(){this.selectAll?this.selectedClasses=[...this.classes]:this.selectedClasses=[]},clearSearch(){this.searchQuery=""},openForm(e){"edit"!==e||1===this.selectedClasses.length?(this.formMode=e,this.showFormModal=!0):alert("Please select exactly one class to edit.")},closeForm(){this.showFormModal=!1},handleSaved(){this.fetchClasses(),this.selectedClasses=[],this.selectAll=!1,this.closeForm()}}};const ie=(0,r.A)(re,[["render",z],["__scopeId","data-v-20bd889c"]]);var de=ie;const ue={class:"view-groups"},ce={class:"search-bar"},pe={class:"table-wrapper"},me={class:"animal-table"},he=["value"],ge={class:"footer-buttons"},Le={key:0,class:"modal-overlay"},ke={class:"modal-content"};function ve(e,t,a,o,n,r){const i=(0,l.g2)("GroupForm");return(0,l.uX)(),(0,l.CE)("div",ue,[t[12]||(t[12]=(0,l.Lk)("h2",{class:"heading"},"Animal Groups",-1)),(0,l.Lk)("div",ce,[(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>n.searchQuery=e),placeholder:"Search by Short Name"},null,512),[[s.Jo,n.searchQuery]]),(0,l.Lk)("button",{class:"clear",onClick:t[1]||(t[1]=(...e)=>r.clearSearch&&r.clearSearch(...e))},"Clear")]),(0,l.Lk)("div",pe,[(0,l.Lk)("table",me,[(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("th",null,[(0,l.bo)((0,l.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=e=>n.selectAll=e),onChange:t[3]||(t[3]=(...e)=>r.toggleSelectAll&&r.toggleSelectAll(...e))},null,544),[[s.lH,n.selectAll]])]),t[7]||(t[7]=(0,l.Lk)("th",null,"ID",-1)),t[8]||(t[8]=(0,l.Lk)("th",null,"Short Name",-1)),t[9]||(t[9]=(0,l.Lk)("th",null,"Long Name",-1)),t[10]||(t[10]=(0,l.Lk)("th",null,"Active",-1)),t[11]||(t[11]=(0,l.Lk)("th",null,"Date Valid",-1))])]),(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.displayedGroups,(e=>((0,l.uX)(),(0,l.CE)("tr",{key:e.id},[(0,l.Lk)("td",null,[(0,l.bo)((0,l.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=e=>n.selectedGroups=e),value:e},null,8,he),[[s.lH,n.selectedGroups]])]),(0,l.Lk)("td",null,(0,$.v_)(e.id),1),(0,l.Lk)("td",null,(0,$.v_)(e.nameGrpShort),1),(0,l.Lk)("td",null,(0,$.v_)(e.nameGrpLong),1),(0,l.Lk)("td",null,(0,$.v_)(e.active?"Yes":"No"),1),(0,l.Lk)("td",null,(0,$.v_)(e.dateValid),1)])))),128))])])]),(0,l.Lk)("div",ge,[(0,l.Lk)("button",{class:"btn add-btn",onClick:t[5]||(t[5]=e=>r.openForm("add"))},"Add"),(0,l.Lk)("button",{class:"btn edit-btn",onClick:t[6]||(t[6]=e=>r.openForm("edit"))},"Edit")]),n.showFormModal?((0,l.uX)(),(0,l.CE)("div",Le,[(0,l.Lk)("div",ke,[(0,l.bF)(i,{mode:n.formMode,existingGroup:"edit"===n.formMode?n.selectedGroups[0]:null,nextGroupId:"add"===n.formMode?n.nextGroupId:null,onClose:r.closeForm,onSaved:r.handleSaved},null,8,["mode","existingGroup","nextGroupId","onClose","onSaved"])])])):(0,l.Q3)("",!0)])}const be={class:"group-form-card"},fe={class:"form-title"},ye={class:"form-group"},Ce={class:"form-group"},Ae={class:"form-group"},we={class:"date-range-picker"},Se={class:"form-group active-toggle-group"},De={class:"toggle-switch"},Ge={class:"toggle-label"},xe={class:"form-actions"},Ve={type:"submit",class:"btn btn-submit"};function Ie(e,t,a,o,n,r){return(0,l.uX)(),(0,l.CE)("div",be,[(0,l.Lk)("h2",fe,(0,$.v_)("add"===a.mode?"Add New Group":"Edit Group"),1),(0,l.Lk)("form",{onSubmit:t[8]||(t[8]=(0,s.D$)(((...e)=>r.handleSubmit&&r.handleSubmit(...e)),["prevent"])),class:"group-form"},[(0,l.Lk)("div",ye,[t[9]||(t[9]=(0,l.Lk)("label",{for:"shortName"},"Short Name *",-1)),(0,l.bo)((0,l.Lk)("input",{id:"shortName","onUpdate:modelValue":t[0]||(t[0]=e=>n.formData.nameGrpShort=e),placeholder:"Enter short name",required:"",class:"form-input"},null,512),[[s.Jo,n.formData.nameGrpShort]])]),(0,l.Lk)("div",Ce,[t[10]||(t[10]=(0,l.Lk)("label",{for:"longName"},"Long Name *",-1)),(0,l.bo)((0,l.Lk)("input",{id:"longName","onUpdate:modelValue":t[1]||(t[1]=e=>n.formData.nameGrpLong=e),placeholder:"Enter long name",required:"",class:"form-input"},null,512),[[s.Jo,n.formData.nameGrpLong]])]),(0,l.Lk)("div",Ae,[t[12]||(t[12]=(0,l.Lk)("label",null,"Date Range *",-1)),(0,l.Lk)("div",we,[(0,l.bo)((0,l.Lk)("input",{type:"date","onUpdate:modelValue":t[2]||(t[2]=e=>n.startDate=e),onChange:t[3]||(t[3]=(...e)=>r.updateDateRange&&r.updateDateRange(...e)),required:"",class:"date-input"},null,544),[[s.Jo,n.startDate]]),t[11]||(t[11]=(0,l.Lk)("span",{class:"date-separator"},"to",-1)),(0,l.bo)((0,l.Lk)("input",{type:"date","onUpdate:modelValue":t[4]||(t[4]=e=>n.endDate=e),onChange:t[5]||(t[5]=(...e)=>r.updateDateRange&&r.updateDateRange(...e)),class:"date-input"},null,544),[[s.Jo,n.endDate]])]),t[13]||(t[13]=(0,l.Lk)("small",{class:"hint"},"Format: [start date, end date)",-1))]),(0,l.Lk)("div",Se,[t[15]||(t[15]=(0,l.Lk)("label",null,"Active Status",-1)),(0,l.Lk)("label",De,[(0,l.bo)((0,l.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=e=>n.formData.active=e),class:"toggle-input"},null,512),[[s.lH,n.formData.active]]),t[14]||(t[14]=(0,l.Lk)("span",{class:"toggle-slider"},null,-1)),(0,l.Lk)("span",Ge,(0,$.v_)(n.formData.active?"Active":"Inactive"),1)])]),(0,l.Lk)("div",xe,[(0,l.Lk)("button",{type:"button",onClick:t[7]||(t[7]=t=>e.$emit("close")),class:"btn btn-cancel"},"Cancel"),(0,l.Lk)("button",Ve,(0,$.v_)("add"===a.mode?"Add Group":"Save Changes"),1)])],32)])}var Ee={name:"GroupForm",props:{mode:{type:String,required:!0},existingGroup:{type:Object,default:null},nextGroupId:{type:Number,default:null}},data(){return{formData:{id:null,nameGrpShort:"",nameGrpLong:"",active:!0,dateValid:""},startDate:"",endDate:""}},created(){if("edit"===this.mode&&this.existingGroup){this.formData={id:this.existingGroup.id,nameGrpShort:this.existingGroup.nameGrpShort,nameGrpLong:this.existingGroup.nameGrpLong,active:this.existingGroup.active,dateValid:this.existingGroup.dateValid};const e=this.formData.dateValid.match(/\[(.*?),(.*?)\)/);e&&3===e.length&&(this.startDate=e[1].trim(),this.endDate=e[2].trim())}"add"===this.mode&&this.nextGroupId&&(this.formData.id=this.nextGroupId)},methods:{updateDateRange(){this.startDate&&(this.formData.dateValid=`[${this.startDate},${this.endDate||""})`)},async handleSubmit(){try{if(!this.startDate)return void alert("Start Date is mandatory!");this.updateDateRange();const e="add"===this.mode?"/api/groups/add":"/api/groups/edit",t=await M.A.post(e,this.formData);t.data&&t.data.includes("already exists")?alert(t.data):(alert("add"===this.mode?"Group added successfully!":"Group updated successfully!"),this.$emit("saved"))}catch(e){console.error("Error:",e),alert("Failed to save group.")}}}};const Fe=(0,r.A)(Ee,[["render",Ie],["__scopeId","data-v-91b1c57e"]]);var _e=Fe,Ue={name:"ViewGroup",components:{GroupForm:_e},data(){return{groups:[],searchQuery:"",selectedGroups:[],selectAll:!1,showFormModal:!1,formMode:"add",nextGroupId:null}},computed:{displayedGroups(){return""!==this.searchQuery.trim()?this.groups.filter((e=>e.nameGrpShort.toLowerCase().includes(this.searchQuery.toLowerCase()))):this.groups}},created(){this.fetchGroups()},methods:{fetchGroups(){M.A.get("/api/groups/all").then((e=>{this.groups=e.data,this.calculateNextId()})).catch((e=>{console.error("Error fetching groups:",e)}))},calculateNextId(){this.groups.length>0?this.nextGroupId=Math.max(...this.groups.map((e=>e.id)))+1:this.nextGroupId=1},toggleSelectAll(){this.selectAll?this.selectedGroups=[...this.groups]:this.selectedGroups=[]},clearSearch(){this.searchQuery=""},openForm(e){"edit"!==e||1===this.selectedGroups.length?(this.formMode=e,this.showFormModal=!0):alert("Please select exactly one group to edit.")},closeForm(){this.showFormModal=!1},handleSaved(){this.fetchGroups(),this.selectedGroups=[],this.selectAll=!1,this.closeForm()}}};const Me=(0,r.A)(Ue,[["render",ve],["__scopeId","data-v-467eb592"]]);var Ne=Me;const Oe={class:"view-lmus"},Re={class:"search-bar"},Xe={class:"table-wrapper"},$e={class:"animal-table"},Je=["value"],Qe={class:"footer-buttons"},qe={key:0,class:"modal-overlay"},Ke={class:"modal-content"};function Pe(e,t,a,o,n,r){const i=(0,l.g2)("LmuForm");return(0,l.uX)(),(0,l.CE)("div",Oe,[t[12]||(t[12]=(0,l.Lk)("h2",{class:"heading"},"Land Management Units (LMU)",-1)),(0,l.Lk)("div",Re,[(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>n.searchQuery=e),placeholder:"Search by Label"},null,512),[[s.Jo,n.searchQuery]]),(0,l.Lk)("button",{class:"clear",onClick:t[1]||(t[1]=(...e)=>r.clearSearch&&r.clearSearch(...e))},"Clear")]),(0,l.Lk)("div",Xe,[(0,l.Lk)("table",$e,[(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("th",null,[(0,l.bo)((0,l.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=e=>n.selectAll=e),onChange:t[3]||(t[3]=(...e)=>r.toggleSelectAll&&r.toggleSelectAll(...e))},null,544),[[s.lH,n.selectAll]])]),t[6]||(t[6]=(0,l.Lk)("th",null,"GID",-1)),t[7]||(t[7]=(0,l.Lk)("th",null,"Label",-1)),t[8]||(t[8]=(0,l.Lk)("th",null,"Type",-1)),t[9]||(t[9]=(0,l.Lk)("th",null,"Grzbl Factor",-1)),t[10]||(t[10]=(0,l.Lk)("th",null,"Area (ha)",-1)),t[11]||(t[11]=(0,l.Lk)("th",null,"Date Valid",-1))])]),(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.displayedLmus,(e=>((0,l.uX)(),(0,l.CE)("tr",{key:e.gid},[(0,l.Lk)("td",null,[(0,l.bo)((0,l.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=e=>n.selectedLmus=e),value:e},null,8,Je),[[s.lH,n.selectedLmus]])]),(0,l.Lk)("td",null,(0,$.v_)(e.gid),1),(0,l.Lk)("td",null,(0,$.v_)(e.label),1),(0,l.Lk)("td",null,(0,$.v_)(e.type),1),(0,l.Lk)("td",null,(0,$.v_)(e.grzblFactor),1),(0,l.Lk)("td",null,(0,$.v_)(e.areaHectares),1),(0,l.Lk)("td",null,(0,$.v_)(e.dateValid?.value||""),1)])))),128))])])]),(0,l.Lk)("div",Qe,[(0,l.Lk)("button",{class:"btn edit-btn",onClick:t[5]||(t[5]=e=>r.openForm("edit"))},"Edit")]),n.showFormModal?((0,l.uX)(),(0,l.CE)("div",qe,[(0,l.Lk)("div",Ke,[(0,l.bF)(i,{mode:n.formMode,existingLmu:1===n.selectedLmus.length?n.selectedLmus[0]:null,onClose:r.closeForm,onSaved:r.handleSaved},null,8,["mode","existingLmu","onClose","onSaved"])])])):(0,l.Q3)("",!0)])}const Te={class:"group-form-card"},je={class:"form-group"},He={class:"form-group"},ze={class:"form-group"},Be={class:"form-group"},We={class:"date-range-picker"},Ye={class:"form-actions"};function Ze(e,t,a,o,n,r){return(0,l.uX)(),(0,l.CE)("div",Te,[t[17]||(t[17]=(0,l.Lk)("h2",{class:"form-title"},"Edit LMU",-1)),(0,l.Lk)("form",{onSubmit:t[8]||(t[8]=(0,s.D$)(((...e)=>r.handleSubmit&&r.handleSubmit(...e)),["prevent"])),class:"group-form"},[(0,l.Lk)("div",je,[t[9]||(t[9]=(0,l.Lk)("label",{for:"label"},"Label *",-1)),(0,l.bo)((0,l.Lk)("input",{id:"label","onUpdate:modelValue":t[0]||(t[0]=e=>n.formData.label=e),placeholder:"Enter label",required:"",class:"form-input"},null,512),[[s.Jo,n.formData.label]])]),(0,l.Lk)("div",He,[t[11]||(t[11]=(0,l.Lk)("label",{for:"type"},"Type *",-1)),(0,l.bo)((0,l.Lk)("select",{id:"type","onUpdate:modelValue":t[1]||(t[1]=e=>n.formData.type=e),required:"",class:"form-input"},t[10]||(t[10]=[(0,l.Lk)("option",{value:""},"Select type",-1),(0,l.Lk)("option",{value:"pasture"},"Pasture",-1),(0,l.Lk)("option",{value:"corral"},"Corral",-1),(0,l.Lk)("option",{value:"alley"},"Alley",-1)]),512),[[s.u1,n.formData.type]])]),(0,l.Lk)("div",ze,[t[12]||(t[12]=(0,l.Lk)("label",{for:"grzblFactor"},"Grazable Factor *",-1)),(0,l.bo)((0,l.Lk)("input",{id:"grzblFactor",type:"number",step:"0.01","onUpdate:modelValue":t[2]||(t[2]=e=>n.formData.grzblFactor=e),placeholder:"Enter grazing factor",required:"",class:"form-input"},null,512),[[s.Jo,n.formData.grzblFactor]])]),(0,l.Lk)("div",Be,[t[14]||(t[14]=(0,l.Lk)("label",null,"Date Range *",-1)),(0,l.Lk)("div",We,[(0,l.bo)((0,l.Lk)("input",{type:"date","onUpdate:modelValue":t[3]||(t[3]=e=>n.startDate=e),onChange:t[4]||(t[4]=(...e)=>r.updateDateRange&&r.updateDateRange(...e)),required:"",class:"date-input"},null,544),[[s.Jo,n.startDate]]),t[13]||(t[13]=(0,l.Lk)("span",{class:"date-separator"},"to",-1)),(0,l.bo)((0,l.Lk)("input",{type:"date","onUpdate:modelValue":t[5]||(t[5]=e=>n.endDate=e),onChange:t[6]||(t[6]=(...e)=>r.updateDateRange&&r.updateDateRange(...e)),class:"date-input"},null,544),[[s.Jo,n.endDate]])]),t[15]||(t[15]=(0,l.Lk)("small",{class:"hint"},"Format: [start date, end date)",-1))]),(0,l.Lk)("div",Ye,[(0,l.Lk)("button",{type:"button",onClick:t[7]||(t[7]=t=>e.$emit("close")),class:"btn btn-cancel"}," Cancel "),t[16]||(t[16]=(0,l.Lk)("button",{type:"submit",class:"btn btn-submit"},"Save Changes",-1))])],32)])}var et={name:"LmuForm",props:{mode:{type:String,required:!0},existingLmu:{type:Object,required:!0}},data(){return{formData:{gid:null,label:"",type:"",grzblFactor:null,dateValid:""},startDate:"",endDate:""}},created(){if("edit"===this.mode&&this.existingLmu&&(this.formData={gid:this.existingLmu.gid,label:this.existingLmu.label,type:this.existingLmu.type,grzblFactor:this.existingLmu.grzblFactor,dateValid:this.existingLmu.dateValid?.value||""},this.formData.dateValid)){const e=this.formData.dateValid.match(/\[(.*?),(.*?)\)/);e&&3===e.length&&(this.startDate=e[1].trim(),this.endDate=e[2].trim())}},methods:{updateDateRange(){this.startDate&&(this.formData.dateValid=`[${this.startDate},${this.endDate||""})`)},async handleSubmit(){try{if(!this.startDate)return void alert("Start Date is mandatory!");this.updateDateRange(),await M.A.post("/api/lmu/edit",this.formData),alert("LMU updated successfully!"),this.$emit("saved")}catch(e){console.error("Error:",e),alert("Failed to update LMU.")}}}};const tt=(0,r.A)(et,[["render",Ze],["__scopeId","data-v-7ebc300c"]]);var at=tt,st={name:"ViewLmu",components:{LmuForm:at},data(){return{lmus:[],searchQuery:"",selectedLmus:[],selectAll:!1,showFormModal:!1,formMode:"edit"}},computed:{displayedLmus(){return""!==this.searchQuery.trim()?this.lmus.filter((e=>e.label.toLowerCase().includes(this.searchQuery.toLowerCase()))):this.lmus}},created(){this.fetchLmus()},methods:{fetchLmus(){M.A.get("/api/lmu/all").then((e=>{this.lmus=e.data})).catch((e=>console.error("Error fetching LMUs:",e)))},toggleSelectAll(){this.selectAll=!this.selectAll,this.selectedLmus=this.selectAll?[...this.lmus]:[]},clearSearch(){this.searchQuery=""},openForm(e){1===this.selectedLmus.length?(this.formMode=e,this.showFormModal=!0):alert("Please select exactly one LMU to edit.")},closeForm(){this.showFormModal=!1},handleSaved(){this.fetchLmus(),this.selectedLmus=[],this.selectAll=!1,this.closeForm()}}};const lt=(0,r.A)(st,[["render",Pe],["__scopeId","data-v-cba3cca8"]]);var ot=lt;const nt={class:"class-form-card"},rt={class:"form-group"},it={class:"form-group"},dt={class:"form-group"};function ut(e,t,a,o,n,r){return(0,l.uX)(),(0,l.CE)("div",{class:"add-user-container",style:(0,$.Tr)(n.backgroundStyle)},[(0,l.Lk)("div",nt,[t[9]||(t[9]=(0,l.Lk)("h2",{class:"form-title"},"Add New User",-1)),(0,l.Lk)("form",{onSubmit:t[3]||(t[3]=(0,s.D$)(((...e)=>r.handleSubmit&&r.handleSubmit(...e)),["prevent"])),class:"class-form"},[(0,l.Lk)("div",rt,[t[4]||(t[4]=(0,l.Lk)("label",{for:"username"},"Username *",-1)),(0,l.bo)((0,l.Lk)("input",{id:"username","onUpdate:modelValue":t[0]||(t[0]=e=>n.formData.username=e),placeholder:"Enter username",required:"",class:"form-input"},null,512),[[s.Jo,n.formData.username]])]),(0,l.Lk)("div",it,[t[5]||(t[5]=(0,l.Lk)("label",{for:"password"},"Password *",-1)),(0,l.bo)((0,l.Lk)("input",{id:"password",type:"password","onUpdate:modelValue":t[1]||(t[1]=e=>n.formData.password=e),placeholder:"Enter password",required:"",class:"form-input"},null,512),[[s.Jo,n.formData.password]])]),(0,l.Lk)("div",dt,[t[7]||(t[7]=(0,l.Lk)("label",{for:"isAdmin"},"Is Admin? *",-1)),(0,l.bo)((0,l.Lk)("select",{id:"isAdmin","onUpdate:modelValue":t[2]||(t[2]=e=>n.formData.isAdmin=e),required:"",class:"form-input"},t[6]||(t[6]=[(0,l.Lk)("option",{value:!0},"Yes",-1),(0,l.Lk)("option",{value:!1},"No",-1)]),512),[[s.u1,n.formData.isAdmin]])]),t[8]||(t[8]=(0,l.Lk)("div",{class:"form-actions"},[(0,l.Lk)("button",{type:"reset",class:"btn btn-cancel"},"Clear"),(0,l.Lk)("button",{type:"submit",class:"btn btn-submit"},"Add User")],-1))],32)])],4)}var ct={name:"AddUser",data(){return{formData:{username:"",password:"",isAdmin:!1},backgroundStyle:{backgroundImage:`url(${G})`,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"}}},methods:{async handleSubmit(){try{const e=await M.A.post("/api/users",this.formData);e.data.success?(alert("User added successfully!"),this.formData.username="",this.formData.password="",this.formData.isAdmin=!1):alert(e.data.message||"Failed to add user.")}catch(e){console.error(e),alert("Server error occurred.")}}}};const pt=(0,r.A)(ct,[["render",ut],["__scopeId","data-v-43cfd4fe"]]);var mt=pt,ht={name:"HomePage",components:{SideNav:D,MapView:X,ViewClass:de,ViewGroup:Ne,ViewLmu:ot,AddUser:mt},data(){return{activeView:"home"}},computed:{currentComponent(){switch(this.activeView){case"viewClass":return"ViewClass";case"viewGroup":return"ViewGroup";case"viewLmu":return"ViewLmu";case"addUser":return"AddUser";default:return"MapView"}}},methods:{setActiveView(e){this.activeView=e}}};const gt=(0,r.A)(ht,[["render",h],["__scopeId","data-v-808c3d44"]]);var Lt=gt;const kt={class:"login-container"},vt={key:0,class:"error"};function bt(e,t,a,o,n,r){return(0,l.uX)(),(0,l.CE)("div",kt,[(0,l.Lk)("form",{onSubmit:t[2]||(t[2]=(0,s.D$)(((...e)=>o.handleLogin&&o.handleLogin(...e)),["prevent"]))},[t[3]||(t[3]=(0,l.Lk)("h2",null,"Login",-1)),(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>o.username=e),placeholder:"Username",required:""},null,512),[[s.Jo,o.username]]),(0,l.bo)((0,l.Lk)("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=e=>o.password=e),placeholder:"Password",required:""},null,512),[[s.Jo,o.password]]),t[4]||(t[4]=(0,l.Lk)("button",{type:"submit"},"Login",-1)),o.errorMessage?((0,l.uX)(),(0,l.CE)("p",vt,(0,$.v_)(o.errorMessage),1)):(0,l.Q3)("",!0)],32)])}var ft={name:"LoginPage",setup(){const e=(0,u.rd)(),t=(0,F.KR)(""),a=(0,F.KR)(""),s=(0,F.KR)(""),l=async()=>{try{const l=await M.A.post("/api/login",null,{params:{username:t.value,password:a.value}});l.data.success?(sessionStorage.setItem("isAuthenticated","true"),sessionStorage.setItem("isAdmin",l.data.isAdmin),e.push("/home")):s.value=l.data.message||"Login failed."}catch(l){s.value="Server error. Please try again."}};return{username:t,password:a,handleLogin:l,errorMessage:s}}};const yt=(0,r.A)(ft,[["render",bt],["__scopeId","data-v-eb0b4242"]]);var Ct=yt;const At={class:"view-groups"},wt={class:"table-container"},St={class:"group-table"},Dt=["checked"],Gt=["onUpdate:modelValue"],xt=["onClick"];function Vt(e,t,a,o,n,r){return(0,l.uX)(),(0,l.CE)("div",At,[(0,l.Lk)("button",{class:"close-btn",onClick:t[0]||(t[0]=(...e)=>o.goBack&&o.goBack(...e))},"X"),(0,l.Lk)("div",wt,[t[6]||(t[6]=(0,l.Lk)("h2",null,"Assigned Animal Groups",-1)),(0,l.Lk)("table",St,[(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("th",null,[(0,l.Lk)("input",{type:"checkbox",checked:o.selectAll,onChange:t[1]||(t[1]=(...e)=>o.toggleAllRows&&o.toggleAllRows(...e))},null,40,Dt)]),t[2]||(t[2]=(0,l.Lk)("th",null,"Group Name",-1)),t[3]||(t[3]=(0,l.Lk)("th",null,"Head",-1)),t[4]||(t[4]=(0,l.Lk)("th",null,"AUE",-1)),t[5]||(t[5]=(0,l.Lk)("th",null,"Actions",-1))])]),(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.groupRows,(e=>((0,l.uX)(),(0,l.CE)("tr",{key:e.id},[(0,l.Lk)("td",null,[(0,l.bo)((0,l.Lk)("input",{type:"checkbox","onUpdate:modelValue":t=>e.selected=t},null,8,Gt),[[s.lH,e.selected]])]),(0,l.Lk)("td",null,(0,$.v_)(e.nameGrpShort),1),(0,l.Lk)("td",null,(0,$.v_)(e.head),1),(0,l.Lk)("td",null,(0,$.v_)(e.aueGrp),1),(0,l.Lk)("td",null,[(0,l.Lk)("button",{class:"view-btn",onClick:t=>o.goToAnimals(e.pairList,e.agid)},"View Animals",8,xt)])])))),128))])])])])}var It={name:"ViewGroups",setup(){const e=(0,u.rd)(),t=(0,F.KR)([]),a=(0,F.KR)(!1),s=()=>{e.push("/home")},o=()=>{a.value=!a.value,t.value.forEach((e=>{e.selected=a.value}))},n=t=>{e.push(`/viewanimals/${t}`)},r=(t,a)=>{sessionStorage.setItem("animalClassPairs",JSON.stringify(t)),sessionStorage.setItem("currentGroupId",a),e.push("/viewanimals")},i=async()=>{try{const e=await M.A.get("/api/animal/named-data");sessionStorage.setItem("animalNamedData",JSON.stringify(e.data))}catch(e){console.error("Failed to fetch animal named-data:",e)}};return(0,l.sV)((async()=>{const e=sessionStorage.getItem("selectedGroupIds");if(!e)return;const a=JSON.parse(e);if(a.length)try{await i();const e=await M.A.post("/api/group/assignments/by-ids",a),s=await M.A.get("/api/groups/all"),l=Object.fromEntries(s.data.map((e=>[e.id,e.nameGrpShort])));sessionStorage.setItem("groupList",JSON.stringify(s.data)),t.value=e.data.map((e=>({...e,nameGrpShort:l[e.agid]||"N/A",pairList:e.animalClassPairs})))}catch(s){console.error("Error loading group data:",s)}})),{groupRows:t,selectAll:a,goBack:s,toggleAllRows:o,viewAnimals:n,goToAnimals:r}}};const Et=(0,r.A)(It,[["render",Vt],["__scopeId","data-v-eb6e51ce"]]);var Ft=Et;const _t={class:"view-animals"},Ut={class:"table-container"},Mt={class:"search-bar"},Nt={class:"group-table"},Ot=["value"],Rt={class:"move-to-dropdown"},Xt=["value"],$t=["disabled"];function Jt(e,t,a,o,n,r){return(0,l.uX)(),(0,l.CE)("div",_t,[(0,l.Lk)("button",{class:"close-btn",onClick:t[0]||(t[0]=(...e)=>o.goBack&&o.goBack(...e))},"X"),(0,l.Lk)("div",Ut,[(0,l.Lk)("h2",null,"Animals in "+(0,$.v_)(o.currentGroupName),1),(0,l.Lk)("div",Mt,[(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>o.searchQuery=e),placeholder:"Search by label..."},null,512),[[s.Jo,o.searchQuery]])]),(0,l.Lk)("table",Nt,[(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("th",null,[(0,l.bo)((0,l.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=e=>o.selectAll=e),onChange:t[3]||(t[3]=(...e)=>o.toggleAll&&o.toggleAll(...e))},null,544),[[s.lH,o.selectAll]])]),t[7]||(t[7]=(0,l.Lk)("th",null,"Label",-1)),t[8]||(t[8]=(0,l.Lk)("th",null,"Name Type",-1)),t[9]||(t[9]=(0,l.Lk)("th",null,"DOB",-1)),t[10]||(t[10]=(0,l.Lk)("th",null,"Sex",-1)),t[11]||(t[11]=(0,l.Lk)("th",null,"Intact",-1)),t[12]||(t[12]=(0,l.Lk)("th",null,"Owner",-1)),t[13]||(t[13]=(0,l.Lk)("th",null,"Class ID",-1))])]),(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.displayedAnimals,(e=>((0,l.uX)(),(0,l.CE)("tr",{key:e.aniId},[(0,l.Lk)("td",null,[(0,l.bo)((0,l.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=e=>o.selected=e),value:e.aniId},null,8,Ot),[[s.lH,o.selected]])]),(0,l.Lk)("td",null,(0,$.v_)(e.label),1),(0,l.Lk)("td",null,(0,$.v_)(e.nameType),1),(0,l.Lk)("td",null,(0,$.v_)(e.dob),1),(0,l.Lk)("td",null,(0,$.v_)(e.sex),1),(0,l.Lk)("td",null,(0,$.v_)(e.intact?"Yes":"No"),1),(0,l.Lk)("td",null,(0,$.v_)(e.owner),1),(0,l.Lk)("td",null,(0,$.v_)(e.clsId),1)])))),128))])]),(0,l.Lk)("div",Rt,[t[15]||(t[15]=(0,l.Lk)("label",{for:"move-select"},"Move to:",-1)),(0,l.bo)((0,l.Lk)("select",{id:"move-select","onUpdate:modelValue":t[5]||(t[5]=e=>o.moveToGroupId=e)},[t[14]||(t[14]=(0,l.Lk)("option",{disabled:"",value:""},"Select group",-1)),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.groupNameOptions,(e=>((0,l.uX)(),(0,l.CE)("option",{key:e.id,value:e.id},(0,$.v_)(e.name),9,Xt)))),128))],512),[[s.u1,o.moveToGroupId]]),(0,l.Lk)("button",{class:"move-btn",onClick:t[6]||(t[6]=(...e)=>o.moveSelectedAnimals&&o.moveSelectedAnimals(...e)),disabled:!o.selected.length||!o.moveToGroupId}," Move ",8,$t)])])])}a(116);var Qt={name:"ViewAnimals",setup(){const e=(0,u.rd)(),t=(0,F.KR)([]),a=(0,F.KR)([]),s=(0,F.KR)(!1),o=(0,F.KR)(""),n=(0,F.KR)(""),r=(0,F.KR)([]),i=(0,F.KR)(null),d=(0,F.KR)(""),c=(0,l.EW)((()=>r.value.filter((e=>e.id!==i.value)).map((e=>({id:e.id,name:e.nameGrpShort}))))),p=()=>{e.push("/viewgroups")},m=()=>{s.value?a.value=t.value.map((e=>e.aniId)):a.value=[]},h=(0,l.EW)((()=>o.value.trim()?t.value.filter((e=>e.label?.toLowerCase().includes(o.value.toLowerCase()))):t.value)),g=()=>{try{const e=sessionStorage.getItem("animalClassPairs"),l=sessionStorage.getItem("animalNamedData"),o=sessionStorage.getItem("groupList");if(i.value=Number(sessionStorage.getItem("currentGroupId")),!e||!l)throw new Error("Missing session data");const n=JSON.parse(e),u=JSON.parse(l);o&&(r.value=JSON.parse(o));const c=Object.fromEntries(u.map((e=>[e.aniId,e])));t.value=n.map((([e,t])=>{const a=c[e]||{};return{aniId:e,clsId:t,label:a.label||"N/A",nameType:a.nameType||"N/A",dob:a.dob||"N/A",sex:a.sex||"N/A",intact:a.intact??!1,owner:a.owner||"N/A"}}));const p=r.value.find((e=>e.id===i.value));d.value=p?p.nameGrpShort:"Selected Group",a.value=[],s.value=!1}catch(l){console.warn("Redirecting due to error:",l.message),e.push("/viewgroups")}},L=async()=>{if(!a.value.length||!n.value)return;const e={sg:r.value.find((e=>e.id===i.value))?.nameGrpShort,tg:r.value.find((e=>e.id===n.value))?.nameGrpShort,animalIds:a.value};try{await M.A.post("/api/group/move-animals",e);const t=await M.A.post("/api/group/assignments/by-ids",[i.value]),a=t.data.find((e=>e.agid===i.value));sessionStorage.setItem("animalClassPairs",JSON.stringify(a?.animalClassPairs||[])),g(),alert("Animals moved successfully.")}catch(t){alert("Failed to move animals: "+t.message)}};return(0,l.sV)((()=>{g()})),{animals:t,selected:a,selectAll:s,toggleAll:m,goBack:p,searchQuery:o,displayedAnimals:h,moveToGroupId:n,groupNameOptions:c,moveSelectedAnimals:L,currentGroupName:d}}};const qt=(0,r.A)(Qt,[["render",Jt],["__scopeId","data-v-37a0b961"]]);var Kt=qt;const Pt=[{path:"/",redirect:"/login"},{path:"/login",component:Ct},{path:"/home",component:Lt,meta:{requiresAuth:!0}},{path:"/viewgroups",component:Ft,meta:{requiresAuth:!0}},{path:"/viewanimals",component:Kt,meta:{requiresAuth:!0}}],Tt=(0,u.aE)({history:(0,u.LA)(),routes:Pt});Tt.beforeEach(((e,t,a)=>{const s=sessionStorage.getItem("isAuthenticated");e.meta.requiresAuth&&!s?a("/login"):a()}));var jt=Tt;(0,s.Ef)(d).use(jt).mount("#app")}},t={};function a(s){var l=t[s];if(void 0!==l)return l.exports;var o=t[s]={exports:{}};return e[s].call(o.exports,o,o.exports,a),o.exports}a.m=e,function(){var e=[];a.O=function(t,s,l,o){if(!s){var n=1/0;for(u=0;u<e.length;u++){s=e[u][0],l=e[u][1],o=e[u][2];for(var r=!0,i=0;i<s.length;i++)(!1&o||n>=o)&&Object.keys(a.O).every((function(e){return a.O[e](s[i])}))?s.splice(i--,1):(r=!1,o<n&&(n=o));if(r){e.splice(u--,1);var d=l();void 0!==d&&(t=d)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[s,l,o]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.p="/"}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,s){var l,o,n=s[0],r=s[1],i=s[2],d=0;if(n.some((function(t){return 0!==e[t]}))){for(l in r)a.o(r,l)&&(a.m[l]=r[l]);if(i)var u=i(a)}for(t&&t(s);d<n.length;d++)o=n[d],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(u)},s=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=a.O(void 0,[504],(function(){return a(3533)}));s=a.O(s)})();
//# sourceMappingURL=app.bef3add0.js.map